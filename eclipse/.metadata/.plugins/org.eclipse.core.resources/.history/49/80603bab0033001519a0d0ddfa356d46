#version 120

uniform sampler2D DiffuseSampler;

varying vec2 texCoord;
varying vec2 oneTexel;

uniform vec2 InSize;

uniform vec3 color;

uniform float tolerance;
uniform float intensity;

void main(){
    vec4 normalColor=texture2D(DiffuseSampler, texCoord);
    gl_FragColor=normalColor;
    
    float difference=(abs(normalColor.x-color.x)+abs(normalColor.y-color.y)+abs(normalColor.z-color.z))-tolerance*3.0;
    if(difference>0){
        float off=1-difference/3.0;
        gl_FragColor*=off;
        gl_FragColor/=intensity;
    }
}
