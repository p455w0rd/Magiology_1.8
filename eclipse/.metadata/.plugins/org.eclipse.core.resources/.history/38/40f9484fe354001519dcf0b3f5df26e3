package com.magiology.gui;

import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;

import net.minecraft.client.Minecraft;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.inventory.Container;

import org.apache.commons.lang3.ArrayUtils;

import com.magiology.Annotations.GUINeedsWorldUpdates;
import com.magiology.Annotations.GUIWorldUpdater;
import com.magiology.util.utilclasses.Helper;

public class GuiUpdater{
	static Minecraft mc=Minecraft.getMinecraft();
	//START~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	//Used all the time--------------------------------------------------------------------------------------------------
	private static GuiUpdater instance;
	public static GuiUpdater GetInstace(){return instance;}
	public static List<GuiProp> registerdGUIs=new ArrayList<GuiProp>();
	public GuiUpdater(){instance=this;}
	//Used in regular game functions-------------------------------------------------------------------------------------
	public static void tryToUpdateOpenContainer(EntityPlayer player){
		if(player==null)return;
		Container container=player.openContainer;
		
		if(container!=null){
			GuiClassScanReturn guiState=guiObjScan(container);
			if(GuiUpdater.guiNeedsUpdates(guiState)){
				for(Method a:guiState.methods){
					Helper.callMethod(a, container);
					if(player.worldObj.isRemote)try{
						mc.currentScreen.getClass().getMethod(a.getName()).invoke(mc.currentScreen);
					}catch(Exception e){}
				}
			}
		}
	}
	//END~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
}
